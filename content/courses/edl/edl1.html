---
date: "2019-05-05T00:00:00+01:00"
draft: false
linktitle: GGPlot2
menu:
  edl:
    parent: Environmental Data Literacy
    weight: 1
title: GGPlot2
type: docs
weight: 1
output: html_document
---



<div id="loading-in-the-libraries" class="section level1">
<h1>Loading in the libraries</h1>
<p>The <em>meta library</em> that contains <code>ggplot2</code> (plus a bunch more) is found in the <code>tidyverse</code> library.</p>
<pre class="r"><code>library( tidyverse )</code></pre>
<pre class="r"><code>data(airquality)
summary(airquality)</code></pre>
<pre><code>##      Ozone          Solar.R         Wind            Temp          Month     
##  Min.   :  1.0   Min.   :  7   Min.   : 1.70   Min.   :56.0   Min.   :5.00  
##  1st Qu.: 18.0   1st Qu.:116   1st Qu.: 7.40   1st Qu.:72.0   1st Qu.:6.00  
##  Median : 31.5   Median :205   Median : 9.70   Median :79.0   Median :7.00  
##  Mean   : 42.1   Mean   :186   Mean   : 9.96   Mean   :77.9   Mean   :6.99  
##  3rd Qu.: 63.2   3rd Qu.:259   3rd Qu.:11.50   3rd Qu.:85.0   3rd Qu.:8.00  
##  Max.   :168.0   Max.   :334   Max.   :20.70   Max.   :97.0   Max.   :9.00  
##  NA&#39;s   :37      NA&#39;s   :7                                                  
##       Day      
##  Min.   : 1.0  
##  1st Qu.: 8.0  
##  Median :16.0  
##  Mean   :15.8  
##  3rd Qu.:23.0  
##  Max.   :31.0  
## </code></pre>
<pre class="r"><code>airquality %&gt;%
  mutate( Month = factor( Month, ordered = TRUE), 
          Day = factor( Day, ordered = TRUE ) ) -&gt; airquality
summary( airquality)</code></pre>
<pre><code>##      Ozone          Solar.R         Wind            Temp      Month 
##  Min.   :  1.0   Min.   :  7   Min.   : 1.70   Min.   :56.0   5:31  
##  1st Qu.: 18.0   1st Qu.:116   1st Qu.: 7.40   1st Qu.:72.0   6:30  
##  Median : 31.5   Median :205   Median : 9.70   Median :79.0   7:31  
##  Mean   : 42.1   Mean   :186   Mean   : 9.96   Mean   :77.9   8:31  
##  3rd Qu.: 63.2   3rd Qu.:259   3rd Qu.:11.50   3rd Qu.:85.0   9:30  
##  Max.   :168.0   Max.   :334   Max.   :20.70   Max.   :97.0         
##  NA&#39;s   :37      NA&#39;s   :7                                          
##       Day     
##  1      :  5  
##  2      :  5  
##  3      :  5  
##  4      :  5  
##  5      :  5  
##  6      :  5  
##  (Other):123</code></pre>
</div>
<div id="components" class="section level1">
<h1>Components</h1>
<pre class="r"><code>ggplot()  +  geom_XXXXX()   +  geom_YYYY() + coord_XXXX() + stat_XXXX()  + theme_XXX()</code></pre>
<div id="aesthetic-mapping" class="section level2">
<h2>Aesthetic Mapping</h2>
<pre class="r"><code>aes( x = Temp, y = Wind )</code></pre>
<pre><code>## Aesthetic mapping: 
## * `x` -&gt; `Temp`
## * `y` -&gt; `Wind`</code></pre>
</div>
<div id="univariate-plots" class="section level2">
<h2>Univariate Plots</h2>
<pre class="r"><code>ggplot( airquality, aes( Wind ) ) + geom_histogram()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( Wind ) ) + geom_histogram( binwidth=0.5 )</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( Wind ) ) + geom_area( stat=&quot;bin&quot;, binwidth=1)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( Wind ) ) + geom_dotplot( binwidth = 0.5 )</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( Wind ) ) + geom_freqpoly( binwidth = 1.0 )</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( sample=Wind ) ) + geom_qq()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( sample=Wind ) ) + geom_qq() + geom_qq_line( color=&quot;red&quot;)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="bivariate-data" class="section level1">
<h1>Bivariate Data</h1>
<div id="continuous-discrete" class="section level2">
<h2>Continuous ~ Discrete</h2>
<pre class="r"><code>ggplot( airquality, aes(x=Month, y=Wind) ) + geom_col()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(x=Wind) ) + geom_bar()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(x=Month, y=Wind) ) + geom_boxplot()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(x=Month, y=Wind) ) + geom_boxplot(notch=TRUE)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(x=Month, y=Wind) ) + geom_violin() </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Month, y = Wind) ) + geom_point() </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Month, y = Wind) ) + geom_point(alpha=0.25) </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="getting-jigggy" class="section level2">
<h2>Getting Jigggy</h2>
<pre class="r"><code>ggplot( airquality, aes( x = Month, y = Wind) ) + geom_point(alpha=0.25) + 
  geom_jitter( shape=2, width=0.2) </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="continuous-continuous" class="section level2">
<h2>Continuous ~ Continuous</h2>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_point()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_point()
ggplot() + geom_point( aes( x = Temp, y = Wind ), data = airquality )
ggplot( airquality ) + geom_point( aes( x = Temp, y = Wind ) )
ggplot( aes( x = Temp, y = Wind ) ) + geom_point( data = airquality )</code></pre>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_point(alpha=0.25) + 
  geom_quantile()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_point() + 
  geom_smooth()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_point() + 
  geom_rug()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>airquality %&gt;% 
  filter( Wind &gt; 20 ) %&gt;% 
  mutate( Label = &quot;Kite Flying&quot;) -&gt; kite.days
kite.days</code></pre>
<pre><code>##   Ozone Solar.R Wind Temp Month Day       Label
## 1     8      19 20.1   61     5   9 Kite Flying
## 2    37     284 20.7   72     6  17 Kite Flying</code></pre>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + 
  geom_point()  + 
  geom_label( aes(label=Label), data = kite.days, position=&quot;nudge&quot;)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_density2d()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Temp, y = Wind) ) + geom_hex()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="continuous-continuous-continuous" class="section level2">
<h2>Continuous ~ Continuous ~ Continuous</h2>
<pre class="r"><code>ggplot( airquality, aes( x=Month, y=Day, z = Wind) ) + geom_contour()</code></pre>
<pre><code>## Warning: Computation failed in `stat_contour()`:
## no proper &#39;z&#39; matrix specified</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># geom_tile() &amp; geom_raster() make the same output
ggplot( airquality, aes( x=Month, y=Day, fill = Wind) ) + 
  geom_tile() + coord_equal()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p &lt;- ggplot( airquality, aes( x=Month, y=Day, fill = Wind) ) + 
  geom_tile() + coord_equal()
p + scale_fill_distiller( palette = &quot;Greens&quot;)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-32-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p + scale_fill_gradient( low=&quot;black&quot;, high=&quot;gold&quot;)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p + scale_fill_gradient2( low=&quot;red&quot;, mid=&quot;white&quot;, high=&quot;green&quot;, midpoint = 10)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="dimensional-plotting" class="section level2">
<h2>3-Dimensional Plotting</h2>
<pre class="r"><code>library(rgl)
open3d()
plot3d( airquality$Ozone, airquality$Wind, airquality$Temp, col=&quot;red&quot;)
for(i in seq(0,360) ) {
  view3d(theta=i)
}</code></pre>
</div>
<div id="animations" class="section level2">
<h2>Animations</h2>
<pre class="r"><code>library(datasauRus)
library(ggplot2)
library(gganimate)
library(gifski)

ggplot(datasaurus_dozen, aes(x=x, y=y))+
  geom_point()+
  theme_minimal() +
  transition_states(dataset, 3, 1) + 
  ease_aes(&#39;cubic-in-out&#39;)
gifski( list.files(pattern=&quot;gganim_plot*&quot;), delay = 0.25)</code></pre>
<div class="figure">
<img src="/img/classes/edl/Animated_Datasets.gif" alt="The Gif" />
<p class="caption">The Gif</p>
</div>
</div>
</div>
<div id="partitions" class="section level1">
<h1>Partitions</h1>
<pre class="r"><code>ggplot( airquality, aes(Wind, fill=Month) ) + 
  geom_histogram(position=&quot;dodge&quot;, binwidth=4)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, fill=Month) ) + 
  geom_density( alpha=0.5 )</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-38-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind)) + 
  geom_histogram( binwidth=1.0) + 
  facet_grid( Month ~ .) </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-39-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, Temp)) + 
  geom_point() + 
  facet_grid( . ~ Day) </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-40-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind,Temp)) + 
  geom_point() + 
  facet_grid( Month ~ Day) </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-41-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="transformations" class="section level1">
<h1>Transformations</h1>
<pre class="r"><code>ggplot( airquality, aes( x = Wind, y = Temp ) ) +
  geom_point() + 
  coord_flip()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Wind, y = Temp ) ) +
  geom_point() + 
  coord_fixed()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>df &lt;- data.frame( x = 0:25, y = 0:25, shape = factor(0:25) )
ggplot( df, aes( x = x, y = y, shape= shape ) ) + geom_point(size=4) + scale_shape_manual( values=0:25)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Wind, y = Temp, shape=factor(Month) ) ) +
  geom_point() + coord_fixed() -&gt; p

p + scale_shape_manual( values=21:25 )</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-46-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Wind, y = Temp ) ) +
  geom_point() + 
  ylim( c(70,80) ) + xlim( c(10,15) )</code></pre>
<pre><code>## Warning: Removed 127 rows containing missing values (geom_point).</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Wind, y = Temp ) ) +
  geom_point() + 
  scale_x_reverse()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-48-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes( x = Wind, y = Temp ) ) +
  geom_point() + 
  scale_y_log10() + 
  scale_x_sqrt()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-49-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>library(GGally)
airquality %&gt;%
  select( Ozone, Solar.R, Wind, Temp ) %&gt;%
  ggpairs()</code></pre>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method = &quot;pearson&quot;, :
## Removed 42 rows containing missing values</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method = &quot;pearson&quot;, :
## Removed 37 rows containing missing values</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method = &quot;pearson&quot;, :
## Removed 37 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 42 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method = &quot;pearson&quot;, :
## Removed 7 rows containing missing values</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method = &quot;pearson&quot;, :
## Removed 7 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-50-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="themes-decorations" class="section level1">
<h1>Themes &amp; Decorations</h1>
<pre class="r"><code>ggplot( airquality, aes(Temp, Wind)) + geom_point() +
  ylab(&quot;Windspeed&quot;) + 
  xlab(&quot;Temperate (F for some reason)&quot;) +
  ggtitle(&quot;This is the title of the Graph&quot;)</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-51-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Temp, Wind, color=Month)) + geom_point() +
  ylab(&quot;Windspeed&quot;) + 
  xlab(&quot;Temperate (F)&quot;) </code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-52-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Temp, Wind, shape=Month)) + geom_point() +
  ylab(&quot;Windspeed&quot;) + 
  xlab(&quot;Temperate (F)&quot;) </code></pre>
<pre><code>## Warning: Using shapes for an ordinal variable is not advised</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-53-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, Temp)) + geom_point()  + 
  theme_bw()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-54-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, Temp)) + geom_point()  + 
  theme_dark()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-55-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, Temp)) + geom_point()  + 
  theme_light()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-56-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, Temp)) + geom_point()  + 
  theme_classic()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-57-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot( airquality, aes(Wind, Temp)) + geom_point()  + 
  theme_void()</code></pre>
<p><img src="/courses/edl/edl1_files/figure-html/unnamed-chunk-58-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>scale = 4.5
USArrests %&gt;%
  ggplot( aes(UrbanPop, Murder) ) + 
  stat_smooth( linetype=2, col=&quot;red&quot;, fill=&quot;#dddddd&quot;, formula = y~x, method=lm, size=.5) +
  geom_point( size = 2 ) + 
  theme_minimal()  + 
  labs( x = &quot;Population&quot;, 
        y = &quot;Assults&quot;, 
        title = &quot;US Arrests (1973)&quot; ) +
  theme(
     text = element_text(family = &quot;docktrin&quot;, size = 16*scale), 
     plot.title = element_text(size = 10*scale, hjust = 0.5),
     panel.grid = element_line(color = &quot;black&quot;),
     axis.text.x = element_text( size = 3*scale),
     axis.text.y = element_text( size = 3*scale ),
     legend.text = element_text( size = scale ),
     axis.title = element_text(size = 10*scale),
     axis.text = element_text(color = &quot;black&quot;))</code></pre>
</div>
